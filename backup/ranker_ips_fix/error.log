ERROR:root:An error occurred:
Traceback (most recent call last):
  File "/home/ec2-user/workspace/cf_rank/main.py", line 236, in <module>
    main(args)
  File "/home/ec2-user/workspace/cf_rank/main.py", line 198, in main
    pyl_trainer.validate(trainer,test_dataloader)
  File "/home/ec2-user/anaconda3/envs/rank3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 639, in validate
    return call._call_and_handle_interrupt(
  File "/home/ec2-user/anaconda3/envs/rank3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 46, in _call_and_handle_interrupt
    return trainer.strategy.launcher.launch(trainer_fn, *args, trainer=trainer, **kwargs)
  File "/home/ec2-user/anaconda3/envs/rank3/lib/python3.9/site-packages/pytorch_lightning/strategies/launchers/subprocess_script.py", line 105, in launch
    return function(*args, **kwargs)
  File "/home/ec2-user/anaconda3/envs/rank3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 679, in _validate_impl
    results = self._run(model, ckpt_path=ckpt_path)
  File "/home/ec2-user/anaconda3/envs/rank3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 981, in _run
    results = self._run_stage()
  File "/home/ec2-user/anaconda3/envs/rank3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 1018, in _run_stage
    return self._evaluation_loop.run()
  File "/home/ec2-user/anaconda3/envs/rank3/lib/python3.9/site-packages/pytorch_lightning/loops/utilities.py", line 178, in _decorator
    return loop_run(self, *args, **kwargs)
  File "/home/ec2-user/anaconda3/envs/rank3/lib/python3.9/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 135, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx, dataloader_iter)
  File "/home/ec2-user/anaconda3/envs/rank3/lib/python3.9/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 396, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_args)
  File "/home/ec2-user/anaconda3/envs/rank3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 319, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/ec2-user/anaconda3/envs/rank3/lib/python3.9/site-packages/pytorch_lightning/strategies/strategy.py", line 411, in validation_step
    return self.lightning_module.validation_step(*args, **kwargs)
  File "/home/ec2-user/workspace/cf_rank/engine.py", line 324, in validation_step
    self.log("val_loss_ranker", out_dict['ranker']['loss'], prog_bar=True, sync_dist=True)
  File "/home/ec2-user/anaconda3/envs/rank3/lib/python3.9/site-packages/pytorch_lightning/core/module.py", line 479, in log
    value = apply_to_collection(value, (Tensor, numbers.Number), self.__to_tensor, name)
  File "/home/ec2-user/anaconda3/envs/rank3/lib/python3.9/site-packages/lightning_utilities/core/apply_func.py", line 64, in apply_to_collection
    return function(data, *args, **kwargs)
  File "/home/ec2-user/anaconda3/envs/rank3/lib/python3.9/site-packages/pytorch_lightning/core/module.py", line 659, in __to_tensor
    raise ValueError(
ValueError: `self.log(val_loss_ranker, tensor([0.4320, 0.5266, 0.3825, 0.3563, 0.3740, 0.3438, 0.4857, 0.3847, 0.4110,
        0.3777, 0.3880, 0.4329, 0.2408, 0.5325, 0.2829, 0.4511, 0.4254, 0.5370,
        0.4473, 0.5219, 0.3405, 0.5133, 0.4313, 0.3434, 0.3529, 0.2024, 0.3261,
        0.3388, 0.3121, 0.5960, 0.2810, 0.4706, 0.3770, 0.4653, 0.1911, 0.6216,
        0.3436, 0.5565, 0.2812, 0.4101, 0.3231, 0.3826, 0.3352, 0.5266, 0.3343,
        0.4176, 0.4637, 0.4339, 0.6089, 0.3069, 0.3553, 0.3893, 0.5239, 0.3609,
        0.4224, 0.3845, 0.3437, 0.3971, 0.2328, 0.4308, 0.3599, 0.3083, 0.4131,
        0.3619, 0.4890, 0.1883, 0.3877, 0.3613, 0.6575, 0.3975, 0.4042, 0.4077,
        0.4446, 0.3112, 0.2939, 0.3680, 0.2174, 0.3805, 0.3817, 0.5088, 0.3704,
        0.4772, 0.4385, 0.3902, 0.5186, 0.3617, 0.4906, 0.4553, 0.4394, 0.3799,
        0.3424, 0.3774, 0.3779, 0.3948, 0.3176, 0.4389, 0.2843, 0.3722, 0.5913,
        0.3672, 0.3837, 0.5676, 0.4615, 0.4152, 0.3979, 0.4839, 0.4978, 0.5933,
        0.3926, 0.4082, 0.4128, 0.3399, 0.4058, 0.3744, 0.4565, 0.4540, 0.4730,
        0.4127, 0.3110, 0.2408, 0.2819, 0.4695, 0.3730, 0.3632, 0.4057, 0.3394,
        0.3698, 0.2102, 0.3543, 0.3408, 0.4503, 0.4491, 0.3641, 0.4843, 0.3083,
        0.4478, 0.3453, 0.4137, 0.5421, 0.3704, 0.5035, 0.2803, 0.3780, 0.3734,
        0.3068, 0.3920, 0.4352, 0.4152, 0.2692, 0.2853, 0.3134, 0.3962, 0.4598,
        0.5655, 0.4500, 0.4500, 0.4680, 0.4505, 0.2747, 0.6238, 0.5041, 0.2221,
        0.3456, 0.3790, 0.3853, 0.4118, 0.4146, 0.3113, 0.4070, 0.4346, 0.3778,
        0.3887, 0.3028, 0.4189, 0.3283, 0.2128, 0.5294, 0.4060, 0.4240, 0.1540,
        0.3358, 0.2892, 0.3780, 0.3139, 0.6282, 0.3220, 0.2232, 0.4071, 0.3728,
        0.3813, 0.3376, 0.2317, 0.2900, 0.3208, 0.4516, 0.5783, 0.4583, 0.2758,
        0.4877, 0.6614, 0.3498, 0.4998, 0.3571, 0.3634, 0.5467, 0.3141, 0.4592,
        0.2999, 0.3842, 0.3775, 0.3220, 0.4234, 0.3698, 0.3496, 0.4091, 0.6074,
        0.4725, 0.3968, 0.3470, 0.5248, 0.3605, 0.2640, 0.4298, 0.3617, 0.2826,
        0.3995, 0.4189, 0.4644, 0.5073, 0.4160, 0.5273, 0.3797, 0.4036, 0.4775,
        0.2864, 0.4392, 0.3499, 0.3957, 0.4079, 0.4399, 0.6209, 0.2947, 0.3950,
        0.4372, 0.3684, 0.4239, 0.4628, 0.3516, 0.3846, 0.3245, 0.3404, 0.3214,
        0.2812, 0.3958, 0.3794, 0.3024, 0.2609, 0.4753, 0.4704, 0.3690, 0.2847,
        0.3962, 0.3779, 0.3965, 0.3943, 0.3581, 0.4651, 0.3664, 0.3843, 0.4754,
        0.5361, 0.3221, 0.4296, 0.6391, 0.3680, 0.4291, 0.4392, 0.4094, 0.3773,
        0.4240, 0.3659, 0.4203, 0.3185, 0.3308, 0.3609, 0.2825, 0.4381, 0.3970,
        0.3522, 0.3355, 0.4223, 0.2310, 0.5389, 0.4010, 0.3410, 0.4020, 0.3911,
        0.3638, 0.3846, 0.3531, 0.3457, 0.4155, 0.3381, 0.4941, 0.4386, 0.3709,
        0.4214, 0.3079, 0.4809, 0.4170, 0.1665, 0.4631, 0.5244, 0.4576, 0.4024,
        0.3621, 0.3277, 0.3462, 0.3032, 0.4671, 0.4146, 0.3403, 0.2295, 0.2594,
        0.4951, 0.5111, 0.2970, 0.4389, 0.3159, 0.2135, 0.5254, 0.4686, 0.4258,
        0.6055, 0.3824, 0.4566, 0.3514, 0.2527, 0.4068, 0.5125, 0.4994, 0.4391,
        0.4691, 0.5002, 0.4267, 0.4910, 0.4431, 0.1761, 0.5834, 0.3377, 0.3440,
        0.3269, 0.4407, 0.4206, 0.3300, 0.3535, 0.5407, 0.4318, 0.3252, 0.3750,
        0.4090, 0.3283, 0.4233, 0.3669, 0.4669, 0.4534, 0.4751, 0.6154, 0.3771,
        0.3836, 0.4144, 0.3691, 0.4924, 0.4005, 0.3693, 0.1131, 0.4539, 0.6147,
        0.3975, 0.4744, 0.2710, 0.4960, 0.5810, 0.5690, 0.4002, 0.3623, 0.2375,
        0.2830, 0.4528, 0.4117, 0.3616, 0.5107, 0.3241, 0.3574, 0.5268, 0.4620,
        0.3152, 0.2940, 0.4274, 0.4290, 0.3572, 0.4240, 0.3513, 0.4199, 0.1987,
        0.3584, 0.4073, 0.3152, 0.5530, 0.4872, 0.2714, 0.4372, 0.3483, 0.4211,
        0.4715, 0.6308, 0.3976, 0.4335, 0.3296, 0.5090, 0.3114, 0.3966, 0.4193,
        0.3096, 0.4082, 0.3475, 0.1760, 0.3546, 0.3900, 0.5562, 0.2169, 0.2953,
        0.3077, 0.3706, 0.4237, 0.4530, 0.4935, 0.3926, 0.5314, 0.4170, 0.3284,
        0.4040, 0.5084, 0.6403, 0.3686, 0.3070, 0.4083, 0.3928, 0.2897, 0.4635,
        0.4554, 0.3893, 0.1420, 0.5303, 0.3759, 0.4230, 0.3182, 0.4031, 0.3718,
        0.2409, 0.4152, 0.4227, 0.3682, 0.4130, 0.3774, 0.3727, 0.2547, 0.4853,
        0.3675, 0.3937, 0.4200, 0.3377, 0.4483, 0.1342, 0.4201, 0.4099, 0.3934,
        0.3545, 0.4246, 0.3576, 0.5917, 0.5001, 0.4647, 0.3684, 0.3255, 0.3680,
        0.3813, 0.3265, 0.4180, 0.3062, 0.4326, 0.3000, 0.3843, 0.4118, 0.2829,
        0.3564, 0.2891, 0.3939, 0.1630, 0.3318, 0.3894, 0.2479, 0.3499, 0.5205,
        0.2771, 0.4914, 0.3075, 0.3763, 0.5360, 0.5225, 0.6779, 0.4734],
       device='cuda:0'))` was called, but the tensor must have a single element. You can try doing `self.log(val_loss_ranker, tensor([0.4320, 0.5266, 0.3825, 0.3563, 0.3740, 0.3438, 0.4857, 0.3847, 0.4110,
        0.3777, 0.3880, 0.4329, 0.2408, 0.5325, 0.2829, 0.4511, 0.4254, 0.5370,
        0.4473, 0.5219, 0.3405, 0.5133, 0.4313, 0.3434, 0.3529, 0.2024, 0.3261,
        0.3388, 0.3121, 0.5960, 0.2810, 0.4706, 0.3770, 0.4653, 0.1911, 0.6216,
        0.3436, 0.5565, 0.2812, 0.4101, 0.3231, 0.3826, 0.3352, 0.5266, 0.3343,
        0.4176, 0.4637, 0.4339, 0.6089, 0.3069, 0.3553, 0.3893, 0.5239, 0.3609,
        0.4224, 0.3845, 0.3437, 0.3971, 0.2328, 0.4308, 0.3599, 0.3083, 0.4131,
        0.3619, 0.4890, 0.1883, 0.3877, 0.3613, 0.6575, 0.3975, 0.4042, 0.4077,
        0.4446, 0.3112, 0.2939, 0.3680, 0.2174, 0.3805, 0.3817, 0.5088, 0.3704,
        0.4772, 0.4385, 0.3902, 0.5186, 0.3617, 0.4906, 0.4553, 0.4394, 0.3799,
        0.3424, 0.3774, 0.3779, 0.3948, 0.3176, 0.4389, 0.2843, 0.3722, 0.5913,
        0.3672, 0.3837, 0.5676, 0.4615, 0.4152, 0.3979, 0.4839, 0.4978, 0.5933,
        0.3926, 0.4082, 0.4128, 0.3399, 0.4058, 0.3744, 0.4565, 0.4540, 0.4730,
        0.4127, 0.3110, 0.2408, 0.2819, 0.4695, 0.3730, 0.3632, 0.4057, 0.3394,
        0.3698, 0.2102, 0.3543, 0.3408, 0.4503, 0.4491, 0.3641, 0.4843, 0.3083,
        0.4478, 0.3453, 0.4137, 0.5421, 0.3704, 0.5035, 0.2803, 0.3780, 0.3734,
        0.3068, 0.3920, 0.4352, 0.4152, 0.2692, 0.2853, 0.3134, 0.3962, 0.4598,
        0.5655, 0.4500, 0.4500, 0.4680, 0.4505, 0.2747, 0.6238, 0.5041, 0.2221,
        0.3456, 0.3790, 0.3853, 0.4118, 0.4146, 0.3113, 0.4070, 0.4346, 0.3778,
        0.3887, 0.3028, 0.4189, 0.3283, 0.2128, 0.5294, 0.4060, 0.4240, 0.1540,
        0.3358, 0.2892, 0.3780, 0.3139, 0.6282, 0.3220, 0.2232, 0.4071, 0.3728,
        0.3813, 0.3376, 0.2317, 0.2900, 0.3208, 0.4516, 0.5783, 0.4583, 0.2758,
        0.4877, 0.6614, 0.3498, 0.4998, 0.3571, 0.3634, 0.5467, 0.3141, 0.4592,
        0.2999, 0.3842, 0.3775, 0.3220, 0.4234, 0.3698, 0.3496, 0.4091, 0.6074,
        0.4725, 0.3968, 0.3470, 0.5248, 0.3605, 0.2640, 0.4298, 0.3617, 0.2826,
        0.3995, 0.4189, 0.4644, 0.5073, 0.4160, 0.5273, 0.3797, 0.4036, 0.4775,
        0.2864, 0.4392, 0.3499, 0.3957, 0.4079, 0.4399, 0.6209, 0.2947, 0.3950,
        0.4372, 0.3684, 0.4239, 0.4628, 0.3516, 0.3846, 0.3245, 0.3404, 0.3214,
        0.2812, 0.3958, 0.3794, 0.3024, 0.2609, 0.4753, 0.4704, 0.3690, 0.2847,
        0.3962, 0.3779, 0.3965, 0.3943, 0.3581, 0.4651, 0.3664, 0.3843, 0.4754,
        0.5361, 0.3221, 0.4296, 0.6391, 0.3680, 0.4291, 0.4392, 0.4094, 0.3773,
        0.4240, 0.3659, 0.4203, 0.3185, 0.3308, 0.3609, 0.2825, 0.4381, 0.3970,
        0.3522, 0.3355, 0.4223, 0.2310, 0.5389, 0.4010, 0.3410, 0.4020, 0.3911,
        0.3638, 0.3846, 0.3531, 0.3457, 0.4155, 0.3381, 0.4941, 0.4386, 0.3709,
        0.4214, 0.3079, 0.4809, 0.4170, 0.1665, 0.4631, 0.5244, 0.4576, 0.4024,
        0.3621, 0.3277, 0.3462, 0.3032, 0.4671, 0.4146, 0.3403, 0.2295, 0.2594,
        0.4951, 0.5111, 0.2970, 0.4389, 0.3159, 0.2135, 0.5254, 0.4686, 0.4258,
        0.6055, 0.3824, 0.4566, 0.3514, 0.2527, 0.4068, 0.5125, 0.4994, 0.4391,
        0.4691, 0.5002, 0.4267, 0.4910, 0.4431, 0.1761, 0.5834, 0.3377, 0.3440,
        0.3269, 0.4407, 0.4206, 0.3300, 0.3535, 0.5407, 0.4318, 0.3252, 0.3750,
        0.4090, 0.3283, 0.4233, 0.3669, 0.4669, 0.4534, 0.4751, 0.6154, 0.3771,
        0.3836, 0.4144, 0.3691, 0.4924, 0.4005, 0.3693, 0.1131, 0.4539, 0.6147,
        0.3975, 0.4744, 0.2710, 0.4960, 0.5810, 0.5690, 0.4002, 0.3623, 0.2375,
        0.2830, 0.4528, 0.4117, 0.3616, 0.5107, 0.3241, 0.3574, 0.5268, 0.4620,
        0.3152, 0.2940, 0.4274, 0.4290, 0.3572, 0.4240, 0.3513, 0.4199, 0.1987,
        0.3584, 0.4073, 0.3152, 0.5530, 0.4872, 0.2714, 0.4372, 0.3483, 0.4211,
        0.4715, 0.6308, 0.3976, 0.4335, 0.3296, 0.5090, 0.3114, 0.3966, 0.4193,
        0.3096, 0.4082, 0.3475, 0.1760, 0.3546, 0.3900, 0.5562, 0.2169, 0.2953,
        0.3077, 0.3706, 0.4237, 0.4530, 0.4935, 0.3926, 0.5314, 0.4170, 0.3284,
        0.4040, 0.5084, 0.6403, 0.3686, 0.3070, 0.4083, 0.3928, 0.2897, 0.4635,
        0.4554, 0.3893, 0.1420, 0.5303, 0.3759, 0.4230, 0.3182, 0.4031, 0.3718,
        0.2409, 0.4152, 0.4227, 0.3682, 0.4130, 0.3774, 0.3727, 0.2547, 0.4853,
        0.3675, 0.3937, 0.4200, 0.3377, 0.4483, 0.1342, 0.4201, 0.4099, 0.3934,
        0.3545, 0.4246, 0.3576, 0.5917, 0.5001, 0.4647, 0.3684, 0.3255, 0.3680,
        0.3813, 0.3265, 0.4180, 0.3062, 0.4326, 0.3000, 0.3843, 0.4118, 0.2829,
        0.3564, 0.2891, 0.3939, 0.1630, 0.3318, 0.3894, 0.2479, 0.3499, 0.5205,
        0.2771, 0.4914, 0.3075, 0.3763, 0.5360, 0.5225, 0.6779, 0.4734],
       device='cuda:0').mean())`
ERROR:root:An error occurred:
Traceback (most recent call last):
  File "/home/ec2-user/workspace/cf_rank/main.py", line 236, in <module>
    main(args)
  File "/home/ec2-user/workspace/cf_rank/main.py", line 198, in main
    pyl_trainer.validate(trainer,test_dataloader)
  File "/home/ec2-user/anaconda3/envs/rank3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 639, in validate
    return call._call_and_handle_interrupt(
  File "/home/ec2-user/anaconda3/envs/rank3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 46, in _call_and_handle_interrupt
    return trainer.strategy.launcher.launch(trainer_fn, *args, trainer=trainer, **kwargs)
  File "/home/ec2-user/anaconda3/envs/rank3/lib/python3.9/site-packages/pytorch_lightning/strategies/launchers/subprocess_script.py", line 105, in launch
    return function(*args, **kwargs)
  File "/home/ec2-user/anaconda3/envs/rank3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 679, in _validate_impl
    results = self._run(model, ckpt_path=ckpt_path)
  File "/home/ec2-user/anaconda3/envs/rank3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 981, in _run
    results = self._run_stage()
  File "/home/ec2-user/anaconda3/envs/rank3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 1018, in _run_stage
    return self._evaluation_loop.run()
  File "/home/ec2-user/anaconda3/envs/rank3/lib/python3.9/site-packages/pytorch_lightning/loops/utilities.py", line 178, in _decorator
    return loop_run(self, *args, **kwargs)
  File "/home/ec2-user/anaconda3/envs/rank3/lib/python3.9/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 135, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx, dataloader_iter)
  File "/home/ec2-user/anaconda3/envs/rank3/lib/python3.9/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 396, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_args)
  File "/home/ec2-user/anaconda3/envs/rank3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 319, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/ec2-user/anaconda3/envs/rank3/lib/python3.9/site-packages/pytorch_lightning/strategies/strategy.py", line 411, in validation_step
    return self.lightning_module.validation_step(*args, **kwargs)
  File "/home/ec2-user/workspace/cf_rank/engine.py", line 324, in validation_step
    self.log("val_loss_ranker", out_dict['ranker']['loss'], prog_bar=True, sync_dist=True)
  File "/home/ec2-user/anaconda3/envs/rank3/lib/python3.9/site-packages/pytorch_lightning/core/module.py", line 525, in log
    results.log(
  File "/home/ec2-user/anaconda3/envs/rank3/lib/python3.9/site-packages/pytorch_lightning/trainer/connectors/logger_connector/result.py", line 413, in log
    batch_size = self._extract_batch_size(self[key], batch_size, meta)
  File "/home/ec2-user/anaconda3/envs/rank3/lib/python3.9/site-packages/pytorch_lightning/trainer/connectors/logger_connector/result.py", line 349, in _extract_batch_size
    batch_size = extract_batch_size(self.batch)
  File "/home/ec2-user/anaconda3/envs/rank3/lib/python3.9/site-packages/pytorch_lightning/utilities/data.py", line 87, in extract_batch_size
    raise MisconfigurationException(error_msg)
lightning_fabric.utilities.exceptions.MisconfigurationException: We could not infer the batch_size from the batch. Either simplify its structure or provide the batch_size as `self.log(..., batch_size=batch_size)`.
