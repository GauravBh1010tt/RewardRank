Logging: args  Namespace(lr=2e-05, cls_reg_lr=0.5, batch_size=512, weight_decay=0.01, epochs=26, eval_epochs=1, use_model_preds=1, print_freq=500, max_positions_PE=50, max_items_QG=21, repo_name='philipphager/baidu-ultr_uva-mlm-ctr', perturbation_sampling=False, sampling_type='rand_perturb', ultr_models='ips', lr_drop=18, save_epochs=5, delta_retain=0.5, soft_labels=False, soft_base=0.9, soft_gain=0.02, lr_drop_epochs=None, clip_max_norm=0.1, n_gpus=2, problem_type='classification', save_fname=None, output_path='/home/ec2-user/workspace/outputs/', data_path='/home/ec2-user/workspace/data/custom_click', output_folder='rr_ips_hard_pre_cls_L2.5', load_path='', load_path_reward='/home/ec2-user/workspace/outputs/ultr_ips_fix_new/checkpoints/checkpoint25.pth', load_path_ranker='/home/ec2-user/workspace/outputs/ranker_ips_fix_new/checkpoints/checkpoint25.pth', device='cuda', seed=42, n_viz=0, resume=0, start_epoch=0, eval=False, eval_ultr=False, ste=True, concat_feats=False, pretrain_ranker=True, merge_imgs=False, train_ranker=True, train_ranker_lambda=False, eval_rels=False, force_tnse=False, use_dcg=False, save_cls=False, cls_reg=True, debug=False, use_wandb=False, use_rax=False, use_doc_feat=True, num_workers=4, log_file=<_io.TextIOWrapper name='/home/ec2-user/workspace/outputs/rr_ips_hard_pre_cls_L2.5/out.log' mode='a' encoding='UTF-8'>, wandb_project_name='ranking', limit_train_batches=None, limit_val_batches=None, limit_test_batches=None, output_dir='/home/ec2-user/workspace/outputs/rr_ips_hard_pre_cls_L2.5')

 Resuming  reward _model from :  /home/ec2-user/workspace/outputs/ultr_ips_fix_new/checkpoints/checkpoint25.pth

 Resuming  arranger _model from :  /home/ec2-user/workspace/outputs/ranker_ips_fix_new/checkpoints/checkpoint25.pth
Logging: args  Namespace(lr=2e-05, cls_reg_lr=0.5, batch_size=512, weight_decay=0.01, epochs=26, eval_epochs=1, use_model_preds=1, print_freq=500, max_positions_PE=50, max_items_QG=21, repo_name='philipphager/baidu-ultr_uva-mlm-ctr', perturbation_sampling=False, sampling_type='rand_perturb', ultr_models='ips', lr_drop=18, save_epochs=5, delta_retain=0.5, soft_labels=False, soft_base=0.9, soft_gain=0.02, lr_drop_epochs=None, clip_max_norm=0.1, n_gpus=2, problem_type='classification', save_fname=None, output_path='/home/ec2-user/workspace/outputs/', data_path='/home/ec2-user/workspace/data/custom_click', output_folder='rr_ips_hard_pre_cls_L2.5', load_path='', load_path_reward='/home/ec2-user/workspace/outputs/ultr_ips_fix_new/checkpoints/checkpoint25.pth', load_path_ranker='/home/ec2-user/workspace/outputs/ranker_ips_fix_new/checkpoints/checkpoint25.pth', device='cuda', seed=42, n_viz=0, resume=0, start_epoch=0, eval=False, eval_ultr=False, ste=True, concat_feats=False, pretrain_ranker=True, merge_imgs=False, train_ranker=True, train_ranker_lambda=False, eval_rels=False, force_tnse=False, use_dcg=False, save_cls=False, cls_reg=True, debug=False, use_wandb=False, use_rax=False, use_doc_feat=True, num_workers=4, log_file=<_io.TextIOWrapper name='/home/ec2-user/workspace/outputs/rr_ips_hard_pre_cls_L2.5/out.log' mode='a' encoding='UTF-8'>, wandb_project_name='ranking', limit_train_batches=None, limit_val_batches=None, limit_test_batches=None, output_dir='/home/ec2-user/workspace/outputs/rr_ips_hard_pre_cls_L2.5')

 Resuming  reward _model from :  /home/ec2-user/workspace/outputs/ultr_ips_fix_new/checkpoints/checkpoint25.pth

 Resuming  arranger _model from :  /home/ec2-user/workspace/outputs/ranker_ips_fix_new/checkpoints/checkpoint25.pth

 Val acc " prob_atleast_1click " after  0  epochs :  tensor(0.3955, device='cuda:0', dtype=torch.float64)

 Val acc " prob_atleast_1click " after  1  epochs :  tensor(0.3987, device='cuda:0', dtype=torch.float64)

 Val acc " prob_atleast_1click " after  2  epochs :  tensor(0.3955, device='cuda:0', dtype=torch.float64)

 Val acc " prob_atleast_1click " after  3  epochs :  tensor(0.3940, device='cuda:0', dtype=torch.float64)

 Val acc " prob_atleast_1click " after  4  epochs :  tensor(0.4001, device='cuda:0', dtype=torch.float64)

 Val acc " prob_atleast_1click " after  5  epochs :  tensor(0.3950, device='cuda:0', dtype=torch.float64)

 Saving at epoch  5

 Val acc " prob_atleast_1click " after  6  epochs :  tensor(0.3972, device='cuda:0', dtype=torch.float64)

 Val acc " prob_atleast_1click " after  7  epochs :  tensor(0.3945, device='cuda:0', dtype=torch.float64)

 Val acc " prob_atleast_1click " after  8  epochs :  tensor(0.3979, device='cuda:0', dtype=torch.float64)

 Val acc " prob_atleast_1click " after  9  epochs :  tensor(0.3956, device='cuda:0', dtype=torch.float64)

 Val acc " prob_atleast_1click " after  10  epochs :  tensor(0.3930, device='cuda:0', dtype=torch.float64)

 Saving at epoch  10

 Val acc " prob_atleast_1click " after  11  epochs :  tensor(0.3952, device='cuda:0', dtype=torch.float64)

 Val acc " prob_atleast_1click " after  12  epochs :  tensor(0.3941, device='cuda:0', dtype=torch.float64)

 Val acc " prob_atleast_1click " after  13  epochs :  tensor(0.3956, device='cuda:0', dtype=torch.float64)

 Val acc " prob_atleast_1click " after  14  epochs :  tensor(0.3918, device='cuda:0', dtype=torch.float64)

 Val acc " prob_atleast_1click " after  15  epochs :  tensor(0.3937, device='cuda:0', dtype=torch.float64)

 Saving at epoch  15

 Val acc " prob_atleast_1click " after  16  epochs :  tensor(0.3931, device='cuda:0', dtype=torch.float64)

 Val acc " prob_atleast_1click " after  17  epochs :  tensor(0.3945, device='cuda:0', dtype=torch.float64)

 Val acc " prob_atleast_1click " after  18  epochs :  tensor(0.3955, device='cuda:0', dtype=torch.float64)

 Val acc " prob_atleast_1click " after  19  epochs :  tensor(0.3952, device='cuda:0', dtype=torch.float64)

 Val acc " prob_atleast_1click " after  20  epochs :  tensor(0.3941, device='cuda:0', dtype=torch.float64)

 Saving at epoch  20

 Val acc " prob_atleast_1click " after  21  epochs :  tensor(0.3954, device='cuda:0', dtype=torch.float64)

 Val acc " prob_atleast_1click " after  22  epochs :  tensor(0.3943, device='cuda:0', dtype=torch.float64)

 Val acc " prob_atleast_1click " after  23  epochs :  tensor(0.3948, device='cuda:0', dtype=torch.float64)

 Val acc " prob_atleast_1click " after  24  epochs :  tensor(0.3956, device='cuda:0', dtype=torch.float64)

 Val acc " prob_atleast_1click " after  25  epochs :  tensor(0.3961, device='cuda:0', dtype=torch.float64)

 Saving at epoch  25
