Logging: args  Namespace(lr=2e-05, batch_size=512, weight_decay=0.01, epochs=25, eval_epochs=1, use_model_preds=1, print_freq=500, max_positions_PE=50, max_items_QG=21, repo_name='philipphager/baidu-ultr_uva-mlm-ctr', perturbation_sampling=False, sampling_type='rand_perturb', ultr_models='ips', lr_drop=15, save_epochs=5, delta_retain=0.5, soft_labels=False, soft_base=0.9, soft_gain=0.02, lr_drop_epochs=None, clip_max_norm=0.1, n_gpus=2, problem_type='classification', save_fname=None, output_path='/home/ec2-user/workspace/outputs/', data_path='/home/ec2-user/workspace/data/custom_click', output_folder='rr_ips_soft', load_path='', load_path_reward='/home/ec2-user/workspace/outputs/ultr_ips/checkpoints/checkpoint30.pth', load_path_ranker='', device='cuda', seed=42, n_viz=0, resume=0, start_epoch=0, eval=False, ste=False, concat_feats=False, pretrain_ranker=False, merge_imgs=False, train_ranker=True, train_ranker_lambda=False, eval_rels=False, force_tnse=False, use_dcg=False, save_cls=False, debug=False, use_wandb=False, use_doc_feat=True, num_workers=4, log_file=<_io.TextIOWrapper name='/home/ec2-user/workspace/outputs/rr_ips_soft/out.log' mode='a' encoding='UTF-8'>, wandb_project_name='ranking', limit_train_batches=None, limit_val_batches=None, limit_test_batches=None, output_dir='/home/ec2-user/workspace/outputs/rr_ips_soft')

 Resuming  reward _model from :  /home/ec2-user/workspace/outputs/ultr_ips/checkpoints/checkpoint30.pth
Logging: args  Namespace(lr=2e-05, batch_size=512, weight_decay=0.01, epochs=25, eval_epochs=1, use_model_preds=1, print_freq=500, max_positions_PE=50, max_items_QG=21, repo_name='philipphager/baidu-ultr_uva-mlm-ctr', perturbation_sampling=False, sampling_type='rand_perturb', ultr_models='ips', lr_drop=15, save_epochs=5, delta_retain=0.5, soft_labels=False, soft_base=0.9, soft_gain=0.02, lr_drop_epochs=None, clip_max_norm=0.1, n_gpus=2, problem_type='classification', save_fname=None, output_path='/home/ec2-user/workspace/outputs/', data_path='/home/ec2-user/workspace/data/custom_click', output_folder='rr_ips_soft', load_path='', load_path_reward='/home/ec2-user/workspace/outputs/ultr_ips/checkpoints/checkpoint30.pth', load_path_ranker='', device='cuda', seed=42, n_viz=0, resume=0, start_epoch=0, eval=False, ste=False, concat_feats=False, pretrain_ranker=False, merge_imgs=False, train_ranker=True, train_ranker_lambda=False, eval_rels=False, force_tnse=False, use_dcg=False, save_cls=False, debug=False, use_wandb=False, use_doc_feat=True, num_workers=4, log_file=<_io.TextIOWrapper name='/home/ec2-user/workspace/outputs/rr_ips_soft/out.log' mode='a' encoding='UTF-8'>, wandb_project_name='ranking', limit_train_batches=None, limit_val_batches=None, limit_test_batches=None, output_dir='/home/ec2-user/workspace/outputs/rr_ips_soft')

 Resuming  reward _model from :  /home/ec2-user/workspace/outputs/ultr_ips/checkpoints/checkpoint30.pth

 Val acc after  0  epochs :  tensor(11.5577, device='cuda:0', dtype=torch.float64)   loss :  0.6350457476430558

 Train acc after  0  epochs :  71.6316745826137   loss :  0.6359027396153727

 Val acc after  1  epochs :  tensor(11.2706, device='cuda:0', dtype=torch.float64)   loss :  0.6333207204093775

 Train acc after  1  epochs :  72.63690990213011   loss :  0.6327620686675175

 Val acc after  2  epochs :  tensor(11.4260, device='cuda:0', dtype=torch.float64)   loss :  0.6346310305074268

 Train acc after  2  epochs :  72.64298179332182   loss :  0.6323456897227355

 Val acc after  3  epochs :  tensor(11.4688, device='cuda:0', dtype=torch.float64)   loss :  0.63887498822539

 Train acc after  3  epochs :  72.7720657023604   loss :  0.6317241317379668

 Val acc after  4  epochs :  tensor(11.9885, device='cuda:0', dtype=torch.float64)   loss :  0.6411887523173626

 Train acc after  4  epochs :  72.52221862406448   loss :  0.6326714068178286

 Val acc after  5  epochs :  tensor(11.3239, device='cuda:0', dtype=torch.float64)   loss :  0.6344101940889075

 Saving at epoch  5

 Train acc after  5  epochs :  72.42619278929189   loss :  0.6332069408223164

 Val acc after  6  epochs :  tensor(11.2996, device='cuda:0', dtype=torch.float64)   loss :  0.6350681286309307

 Train acc after  6  epochs :  72.75092652561888   loss :  0.6319353431193514

 Val acc after  7  epochs :  tensor(12.4068, device='cuda:0', dtype=torch.float64)   loss :  0.6464738017048538

 Train acc after  7  epochs :  72.81569336499712   loss :  0.6319495496665279

 Val acc after  8  epochs :  tensor(11.4062, device='cuda:0', dtype=torch.float64)   loss :  0.6341810443005302

 Train acc after  8  epochs :  72.43057804404145   loss :  0.6334677964745484

 Val acc after  9  epochs :  tensor(11.4311, device='cuda:0', dtype=torch.float64)   loss :  0.6350004898252904

 Train acc after  9  epochs :  72.7277633851468   loss :  0.6322176442048121

 Val acc after  10  epochs :  tensor(11.4607, device='cuda:0', dtype=torch.float64)   loss :  0.6344459590080622

 Saving at epoch  10

 Train acc after  10  epochs :  72.25820379965458   loss :  0.6342198242874564

 Val acc after  11  epochs :  tensor(11.6136, device='cuda:0', dtype=torch.float64)   loss :  0.6357688724067702

 Train acc after  11  epochs :  72.32769322107082   loss :  0.6337376366608909

 Val acc after  12  epochs :  tensor(11.7482, device='cuda:0', dtype=torch.float64)   loss :  0.637268418924024

 Train acc after  12  epochs :  72.16049132843983   loss :  0.6345144768168745

 Val acc after  13  epochs :  tensor(13.2127, device='cuda:0', dtype=torch.float64)   loss :  0.6502862210105091

 Train acc after  13  epochs :  71.68924510650547   loss :  0.636823582989756

 Val acc after  14  epochs :  tensor(13.3381, device='cuda:0', dtype=torch.float64)   loss :  0.6522728876239525

 Train acc after  14  epochs :  71.38452612262522   loss :  0.6385846275438751

 Val acc after  15  epochs :  tensor(13.3032, device='cuda:0', dtype=torch.float64)   loss :  0.651929078837218

 Saving at epoch  15

 Train acc after  15  epochs :  72.18196783246978   loss :  0.636206038467929

 Val acc after  16  epochs :  tensor(13.2813, device='cuda:0', dtype=torch.float64)   loss :  0.6517310199624752

 Train acc after  16  epochs :  72.40437895797352   loss :  0.6353153549032861

 Val acc after  17  epochs :  tensor(13.2736, device='cuda:0', dtype=torch.float64)   loss :  0.6520521050734421

 Train acc after  17  epochs :  72.66074769717905   loss :  0.6347071234311639

 Val acc after  18  epochs :  tensor(12.9207, device='cuda:0', dtype=torch.float64)   loss :  0.6485564812679271

 Train acc after  18  epochs :  72.722141263673   loss :  0.6336934004962772

 Val acc after  19  epochs :  tensor(12.9437, device='cuda:0', dtype=torch.float64)   loss :  0.6487499008986541

 Train acc after  19  epochs :  72.85313669401266   loss :  0.6332487850974275

 Val acc after  20  epochs :  tensor(12.9692, device='cuda:0', dtype=torch.float64)   loss :  0.6487181550185755

 Saving at epoch  20

 Train acc after  20  epochs :  72.91857818796775   loss :  0.6328120779630675

 Val acc after  21  epochs :  tensor(12.4095, device='cuda:0', dtype=torch.float64)   loss :  0.6439934451069971

 Train acc after  21  epochs :  72.97693580886586   loss :  0.6325209592154231

 Val acc after  22  epochs :  tensor(12.2628, device='cuda:0', dtype=torch.float64)   loss :  0.6427624168523708

 Train acc after  22  epochs :  73.10039759643062   loss :  0.6326167545394784

 Val acc after  23  epochs :  tensor(12.3268, device='cuda:0', dtype=torch.float64)   loss :  0.6431712866943997

 Train acc after  23  epochs :  73.03473121761658   loss :  0.632585705123776

 Val acc after  24  epochs :  tensor(12.7433, device='cuda:0', dtype=torch.float64)   loss :  0.6467988058245908

 Train acc after  24  epochs :  73.07397362550374   loss :  0.6324684527397613
