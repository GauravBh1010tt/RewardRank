Logging: args  Namespace(lr=2e-05, batch_size=512, weight_decay=0.01, epochs=25, eval_epochs=1, use_model_preds=1, print_freq=500, max_positions_PE=50, max_items_QG=21, repo_name='philipphager/baidu-ultr_uva-mlm-ctr', perturbation_sampling=False, sampling_type='rand_perturb', ultr_models='ips', lr_drop=15, save_epochs=5, delta_retain=0.5, soft_labels=False, soft_base=0.9, soft_gain=0.02, lr_drop_epochs=None, clip_max_norm=0.1, n_gpus=2, problem_type='classification', save_fname=None, output_path='/home/ec2-user/workspace/outputs/', data_path='/home/ec2-user/workspace/data/custom_click', output_folder='rr_ips_hard', load_path='', load_path_reward='/home/ec2-user/workspace/outputs/ultr_ips/checkpoints/checkpoint30.pth', load_path_ranker='', device='cuda', seed=42, n_viz=0, resume=0, start_epoch=0, eval=False, ste=True, concat_feats=False, pretrain_ranker=False, merge_imgs=False, train_ranker=True, train_ranker_lambda=False, eval_rels=False, force_tnse=False, use_dcg=False, save_cls=False, debug=False, use_wandb=False, use_doc_feat=True, num_workers=4, log_file=<_io.TextIOWrapper name='/home/ec2-user/workspace/outputs/rr_ips_hard/out.log' mode='a' encoding='UTF-8'>, wandb_project_name='ranking', limit_train_batches=None, limit_val_batches=None, limit_test_batches=None, output_dir='/home/ec2-user/workspace/outputs/rr_ips_hard')

 Resuming  reward _model from :  /home/ec2-user/workspace/outputs/ultr_ips/checkpoints/checkpoint30.pth
Logging: args  Namespace(lr=2e-05, batch_size=512, weight_decay=0.01, epochs=25, eval_epochs=1, use_model_preds=1, print_freq=500, max_positions_PE=50, max_items_QG=21, repo_name='philipphager/baidu-ultr_uva-mlm-ctr', perturbation_sampling=False, sampling_type='rand_perturb', ultr_models='ips', lr_drop=15, save_epochs=5, delta_retain=0.5, soft_labels=False, soft_base=0.9, soft_gain=0.02, lr_drop_epochs=None, clip_max_norm=0.1, n_gpus=2, problem_type='classification', save_fname=None, output_path='/home/ec2-user/workspace/outputs/', data_path='/home/ec2-user/workspace/data/custom_click', output_folder='rr_ips_hard', load_path='', load_path_reward='/home/ec2-user/workspace/outputs/ultr_ips/checkpoints/checkpoint30.pth', load_path_ranker='', device='cuda', seed=42, n_viz=0, resume=0, start_epoch=0, eval=False, ste=True, concat_feats=False, pretrain_ranker=False, merge_imgs=False, train_ranker=True, train_ranker_lambda=False, eval_rels=False, force_tnse=False, use_dcg=False, save_cls=False, debug=False, use_wandb=False, use_doc_feat=True, num_workers=4, log_file=<_io.TextIOWrapper name='/home/ec2-user/workspace/outputs/rr_ips_hard/out.log' mode='a' encoding='UTF-8'>, wandb_project_name='ranking', limit_train_batches=None, limit_val_batches=None, limit_test_batches=None, output_dir='/home/ec2-user/workspace/outputs/rr_ips_hard')

 Resuming  reward _model from :  /home/ec2-user/workspace/outputs/ultr_ips/checkpoints/checkpoint30.pth

 Val acc after  0  epochs :  tensor(12.6166, device='cuda:0', dtype=torch.float64)   loss :  0.6503292171716665

 Train acc after  0  epochs :  72.78971916378813   loss :  0.6461572582118444

 Val acc after  1  epochs :  tensor(12.2303, device='cuda:0', dtype=torch.float64)   loss :  0.6473175829562664

 Train acc after  1  epochs :  71.58354922279793   loss :  0.6518757720920538

 Val acc after  2  epochs :  tensor(12.1328, device='cuda:0', dtype=torch.float64)   loss :  0.6472465959736204

 Train acc after  2  epochs :  71.92357512953367   loss :  0.6495317811750609

 Val acc after  3  epochs :  tensor(12.1152, device='cuda:0', dtype=torch.float64)   loss :  0.6471914642850833

 Train acc after  3  epochs :  73.05924366724237   loss :  0.6445399697157455

 Val acc after  4  epochs :  tensor(12.1537, device='cuda:0', dtype=torch.float64)   loss :  0.6475535235113266

 Train acc after  4  epochs :  73.16606397524467   loss :  0.6441414599414508

 Val acc after  5  epochs :  tensor(12.1029, device='cuda:0', dtype=torch.float64)   loss :  0.647012612524605

 Saving at epoch  5

 Train acc after  5  epochs :  73.25556814910766   loss :  0.6441815680510213

 Val acc after  6  epochs :  tensor(12.0431, device='cuda:0', dtype=torch.float64)   loss :  0.646520265259175

 Train acc after  6  epochs :  73.18574140040299   loss :  0.6444344438016534

 Val acc after  7  epochs :  tensor(11.9954, device='cuda:0', dtype=torch.float64)   loss :  0.6461466252500064

 Train acc after  7  epochs :  73.26298934945308   loss :  0.6442626828024911

 Val acc after  8  epochs :  tensor(11.9840, device='cuda:0', dtype=torch.float64)   loss :  0.6457075775218245

 Train acc after  8  epochs :  73.28053036845135   loss :  0.6436375391707968

 Val acc after  9  epochs :  tensor(11.8820, device='cuda:0', dtype=torch.float64)   loss :  0.6438748192097994

 Train acc after  9  epochs :  73.36980965745538   loss :  0.6437891407596938

 Val acc after  10  epochs :  tensor(12.0531, device='cuda:0', dtype=torch.float64)   loss :  0.6467265129614265

 Saving at epoch  10

 Train acc after  10  epochs :  72.80579843120323   loss :  0.6461960564623331

 Val acc after  11  epochs :  tensor(11.9997, device='cuda:0', dtype=torch.float64)   loss :  0.6460839624642798

 Train acc after  11  epochs :  73.3655368451353   loss :  0.6438236314875789

 Val acc after  12  epochs :  tensor(11.9783, device='cuda:0', dtype=torch.float64)   loss :  0.6459234683835899

 Train acc after  12  epochs :  73.25196999136442   loss :  0.643573532101535

 Val acc after  13  epochs :  tensor(11.9187, device='cuda:0', dtype=torch.float64)   loss :  0.6453629333259623

 Train acc after  13  epochs :  73.35507969919401   loss :  0.6437197421815429

 Val acc after  14  epochs :  tensor(11.9588, device='cuda:0', dtype=torch.float64)   loss :  0.6458571529485403

 Train acc after  14  epochs :  73.36621149971215   loss :  0.6435558986508962

 Val acc after  15  epochs :  tensor(12.0179, device='cuda:0', dtype=torch.float64)   loss :  0.6465698743309691

 Saving at epoch  15

 Train acc after  15  epochs :  73.68161251439263   loss :  0.6426456748269996

 Val acc after  16  epochs :  tensor(12.0330, device='cuda:0', dtype=torch.float64)   loss :  0.6466878276878865

 Train acc after  16  epochs :  73.59154612838226   loss :  0.6429832856202146

 Val acc after  17  epochs :  tensor(12.0210, device='cuda:0', dtype=torch.float64)   loss :  0.6465378541029416

 Train acc after  17  epochs :  73.48303918393782   loss :  0.6433135930546727

 Val acc after  18  epochs :  tensor(12.0319, device='cuda:0', dtype=torch.float64)   loss :  0.64661868711551

 Train acc after  18  epochs :  73.57557930339667   loss :  0.6429261754586126

 Val acc after  19  epochs :  tensor(12.0382, device='cuda:0', dtype=torch.float64)   loss :  0.6467079872358632

 Train acc after  19  epochs :  73.59210834052965   loss :  0.6429891802292258

 Val acc after  20  epochs :  tensor(12.0387, device='cuda:0', dtype=torch.float64)   loss :  0.6467724861511753

 Saving at epoch  20

 Train acc after  20  epochs :  73.45818940702361   loss :  0.6432394694988461

 Val acc after  21  epochs :  tensor(12.0282, device='cuda:0', dtype=torch.float64)   loss :  0.6466234294310504

 Train acc after  21  epochs :  73.46651014680484   loss :  0.6432697718742607

 Val acc after  22  epochs :  tensor(12.0500, device='cuda:0', dtype=torch.float64)   loss :  0.6468675027431583

 Train acc after  22  epochs :  73.50586499712148   loss :  0.6436105480680558

 Val acc after  23  epochs :  tensor(12.0322, device='cuda:0', dtype=torch.float64)   loss :  0.64670201440257

 Train acc after  23  epochs :  73.4431221214738   loss :  0.6434653859446385

 Val acc after  24  epochs :  tensor(12.0344, device='cuda:0', dtype=torch.float64)   loss :  0.6466951715355298

 Train acc after  24  epochs :  73.49147236614853   loss :  0.6435451714504697
