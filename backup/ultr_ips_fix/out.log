Logging: args  Namespace(lr=2e-05, batch_size=512, weight_decay=0.01, epochs=26, eval_epochs=1, use_model_preds=1, print_freq=500, max_positions_PE=50, max_items_QG=21, repo_name='philipphager/baidu-ultr_uva-mlm-ctr', perturbation_sampling=False, sampling_type='rand_perturb', ultr_models='ips', lr_drop=18, save_epochs=5, delta_retain=0.5, soft_labels=False, soft_base=0.9, soft_gain=0.02, lr_drop_epochs=None, clip_max_norm=0.1, n_gpus=2, problem_type='classification', save_fname=None, output_path='/home/ec2-user/workspace/outputs/', data_path='/home/ec2-user/workspace/data/custom_click', output_folder='ultr_ips_fix', load_path='', load_path_reward='', load_path_ranker='', device='cuda', seed=42, n_viz=5, resume=0, start_epoch=0, eval=False, eval_ultr=False, ste=False, concat_feats=False, pretrain_ranker=False, merge_imgs=False, train_ranker=False, train_ranker_lambda=False, eval_rels=False, force_tnse=False, use_dcg=False, save_cls=False, debug=False, use_wandb=False, use_doc_feat=True, num_workers=4, log_file=<_io.TextIOWrapper name='/home/ec2-user/workspace/outputs/ultr_ips_fix/out.log' mode='a' encoding='UTF-8'>, wandb_project_name='ranking', limit_train_batches=None, limit_val_batches=None, limit_test_batches=None, output_dir='/home/ec2-user/workspace/outputs/ultr_ips_fix')
Logging: args  Namespace(lr=2e-05, batch_size=512, weight_decay=0.01, epochs=26, eval_epochs=1, use_model_preds=1, print_freq=500, max_positions_PE=50, max_items_QG=21, repo_name='philipphager/baidu-ultr_uva-mlm-ctr', perturbation_sampling=False, sampling_type='rand_perturb', ultr_models='ips', lr_drop=18, save_epochs=5, delta_retain=0.5, soft_labels=False, soft_base=0.9, soft_gain=0.02, lr_drop_epochs=None, clip_max_norm=0.1, n_gpus=2, problem_type='classification', save_fname=None, output_path='/home/ec2-user/workspace/outputs/', data_path='/home/ec2-user/workspace/data/custom_click', output_folder='ultr_ips_fix', load_path='', load_path_reward='', load_path_ranker='', device='cuda', seed=42, n_viz=5, resume=0, start_epoch=0, eval=False, eval_ultr=False, ste=False, concat_feats=False, pretrain_ranker=False, merge_imgs=False, train_ranker=False, train_ranker_lambda=False, eval_rels=False, force_tnse=False, use_dcg=False, save_cls=False, debug=False, use_wandb=False, use_doc_feat=True, num_workers=4, log_file=<_io.TextIOWrapper name='/home/ec2-user/workspace/outputs/ultr_ips_fix/out.log' mode='a' encoding='UTF-8'>, wandb_project_name='ranking', limit_train_batches=None, limit_val_batches=None, limit_test_batches=None, output_dir='/home/ec2-user/workspace/outputs/ultr_ips_fix')

 Val acc after  0  epochs :  tensor(9.4877, device='cuda:0', dtype=torch.float64)   loss :  0.6180680597136574

 Train acc after  0  epochs :  74.5585510218768   loss :  0.6318532320581294

 Val acc after  1  epochs :  tensor(8.8627, device='cuda:0', dtype=torch.float64)   loss :  0.6134897975360458

 Train acc after  1  epochs :  78.35235859240069   loss :  0.6173298632640225

 Val acc after  2  epochs :  tensor(8.4836, device='cuda:0', dtype=torch.float64)   loss :  0.6110708537190418

 Train acc after  2  epochs :  79.59732117156017   loss :  0.6132279739930238

 Val acc after  3  epochs :  tensor(8.0065, device='cuda:0', dtype=torch.float64)   loss :  0.6090103441828933

 Train acc after  3  epochs :  80.46380253310305   loss :  0.6105428184939791

 Val acc after  4  epochs :  tensor(7.7070, device='cuda:0', dtype=torch.float64)   loss :  0.6070527525970351

 Train acc after  4  epochs :  81.11259535118019   loss :  0.6087061078577632

 Val acc after  5  epochs :  tensor(7.6115, device='cuda:0', dtype=torch.float64)   loss :  0.6062467548369669

 Saving at epoch  5

 Train acc after  5  epochs :  81.5663005541163   loss :  0.6075255351002558

 Val acc after  6  epochs :  tensor(7.4914, device='cuda:0', dtype=torch.float64)   loss :  0.6053905541566621

 Train acc after  6  epochs :  82.02214216321244   loss :  0.6063586102649481

 Val acc after  7  epochs :  tensor(7.3289, device='cuda:0', dtype=torch.float64)   loss :  0.6046091107003975

 Train acc after  7  epochs :  82.41985103626943   loss :  0.6052240793004231

 Val acc after  8  epochs :  tensor(7.2982, device='cuda:0', dtype=torch.float64)   loss :  0.6044665954999852

 Train acc after  8  epochs :  82.73963730569949   loss :  0.6042220686581955

 Val acc after  9  epochs :  tensor(7.1270, device='cuda:0', dtype=torch.float64)   loss :  0.6035871388487514

 Train acc after  9  epochs :  83.03266227691422   loss :  0.6037991389589923

 Val acc after  10  epochs :  tensor(7.0667, device='cuda:0', dtype=torch.float64)   loss :  0.6033275980947957

 Saving at epoch  10

 Train acc after  10  epochs :  83.27857387017846   loss :  0.6032371794701309

 Val acc after  11  epochs :  tensor(7.0530, device='cuda:0', dtype=torch.float64)   loss :  0.6029811857960231

 Train acc after  11  epochs :  83.54315090673575   loss :  0.6025123419793277

 Val acc after  12  epochs :  tensor(6.9509, device='cuda:0', dtype=torch.float64)   loss :  0.6029821610099515

 Train acc after  12  epochs :  83.77163392343121   loss :  0.6018091861111355

 Val acc after  13  epochs :  tensor(6.8806, device='cuda:0', dtype=torch.float64)   loss :  0.6022997108864011

 Train acc after  13  epochs :  83.93253904001152   loss :  0.6014698418956529

 Val acc after  14  epochs :  tensor(6.8708, device='cuda:0', dtype=torch.float64)   loss :  0.6021889503762728

 Train acc after  14  epochs :  84.13268656447899   loss :  0.6009420592230418

 Val acc after  15  epochs :  tensor(6.8480, device='cuda:0', dtype=torch.float64)   loss :  0.6024074287196459

 Saving at epoch  15

 Train acc after  15  epochs :  84.30764698474381   loss :  0.6003557115176218

 Val acc after  16  epochs :  tensor(6.7921, device='cuda:0', dtype=torch.float64)   loss :  0.6021257807051271

 Train acc after  16  epochs :  84.51296686096718   loss :  0.6000297883421961

 Val acc after  17  epochs :  tensor(6.7662, device='cuda:0', dtype=torch.float64)   loss :  0.6019697028834934

 Train acc after  17  epochs :  84.77698168537708   loss :  0.5996396614754459

 Val acc after  18  epochs :  tensor(6.6190, device='cuda:0', dtype=torch.float64)   loss :  0.6013147484794484

 Train acc after  18  epochs :  85.49560125215889   loss :  0.597718919595568

 Val acc after  19  epochs :  tensor(6.6114, device='cuda:0', dtype=torch.float64)   loss :  0.6012710398636052

 Train acc after  19  epochs :  85.62760866436385   loss :  0.5974499375264899

 Val acc after  20  epochs :  tensor(6.6047, device='cuda:0', dtype=torch.float64)   loss :  0.6013507388199736

 Saving at epoch  20

 Train acc after  20  epochs :  85.69068886729994   loss :  0.5974061081084135

 Val acc after  21  epochs :  tensor(6.6108, device='cuda:0', dtype=torch.float64)   loss :  0.6012787361174488

 Train acc after  21  epochs :  85.67247319372481   loss :  0.5972721456118086

 Val acc after  22  epochs :  tensor(6.5894, device='cuda:0', dtype=torch.float64)   loss :  0.6011829218164686

 Train acc after  22  epochs :  85.75129533678756   loss :  0.5974164016783053

 Val acc after  23  epochs :  tensor(6.5861, device='cuda:0', dtype=torch.float64)   loss :  0.6012411343504653

 Train acc after  23  epochs :  85.76152759786989   loss :  0.5972362797304858

 Val acc after  24  epochs :  tensor(6.5939, device='cuda:0', dtype=torch.float64)   loss :  0.6013111145465172

 Train acc after  24  epochs :  85.8678981361543   loss :  0.5971270377321801

 Val acc after  25  epochs :  tensor(6.5819, device='cuda:0', dtype=torch.float64)   loss :  0.6012947209560047

 Saving at epoch  25

 Train acc after  25  epochs :  85.87554422135867   loss :  0.5971550720199128
